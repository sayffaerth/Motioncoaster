<!DOCTYPE html>
<html>
  <head>
    <title>Motioncoaster</title>
    <meta name="description" content="Collection of examples for networked-aframe"/>
    <style>
      html {
        background: #000000;
        color: #FAFAFA;
        font-family: monospace;
        font-size: 20px;
        padding: 10px 20px;
        text-align: center;
      }
      h1 {
        font-weight: 300;
      }
      a {
        color: #FAFAFA;
        /*display: block;*/
        padding: 15px 0;
      }
      body > div {
        margin: 20px 0;
      }
    </style>
  </head>
  <body>
    <script>
      function loadARtrack(){
        if(sessionStorage["artrack"]){
          document.location.href = "./vr/artrack.html";
        } else {
          alert("Please upload a motioncoaster.json track first with the button below.");
        }
      }
    </script>
    <h1 style="margin-bottom:2cm;">MOTION(sickness.roller)COASTER</h1>
    <div>
      <a href="./vr/defaulttrack.html">VR Driver</a>
      <span>- default track</span><br/>
      <p style="margin-bottom:2cm; color:#ddd; font-size:14px">
        Try the VR roller coaster with a pre-built track.
      </p>
    </div>
    <div>
      <a href="javascript:loadARtrack()"> VR Driver</a>
      <span>- AR drawn track</span><br/>
      <input id="file-upload-button" type="file" />
      <p style="margin-bottom:2cm; color:#ddd; font-size:14px">
        Drive the VR roller coaster with a custom track.<br/>
        Before clicking the link please upload a JSON generated by the AR Drawer.
      </p>
    </div>
    <div>
      <a href="./ar/index.html">AR Drawer</a>
      <span>- AR track drawer</span>
      <p style="color:#ddd; font-size:14px">
        Draw your own track in AR.<br/>
        Requires an ARCore enabled smartphone with a relatively new version of the Google Chrome app.<br/>
        Theoretically also works on ARKit devices, but in order to access the WebXR interface a corresponding browser is needed.<br/>
        Possible Example: <a href="https://apps.apple.com/us/app/webxr-viewer/id1295998056">WebXR Viewer</a><br/>
        <br/>
        Controls:<br/>
        1. Click the AR button and give camera permissions.<br/>
        2. Place points by tilting your phone horizontally flat (screen points exactly up). After a short delay a new point spawns. They get connected automatically.<br/>
        3. Export your track by holding your phone above your head, horizontally flat (screen points exactly down). After a short delay you will be prompted to download a JSON file.<br/>
        4. Send this JSON file to any friend or other device which shall enjoy a thrilling VR ride. It can the be loaded with the option above.<br/>
        (5. To reset just refresh the window.)<br/>
      </p>
    </div>
    
    <script>
      function importJSON(event) {
        var reader = new FileReader();

        reader.onload = function(event) {
          //Debugging in order to check if provided files from export parse:
          //var jsonObj = JSON.parse(event.target.result);
          //console.log(jsonObj);
          sessionStorage["artrack"] = event.target.result
          console.log(sessionStorage["artrack"])
        }

        reader.readAsText(event.target.files[0]);
      }
      
      document.getElementById('file-upload-button').addEventListener('change', importJSON);
    </script>
  </body>
</html>